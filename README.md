# Sistema de Gest√£o de Tickets - Manhattan

## üìã Vis√£o Geral do Sistema

O Sistema Manhattan √© uma plataforma moderna de gest√£o de tickets desenvolvida com React, TypeScript e Supabase. O sistema oferece uma interface intuitiva para cria√ß√£o, edi√ß√£o e acompanhamento de tickets, com funcionalidades avan√ßadas de permissionamento e personaliza√ß√£o.

### üéØ Principais Funcionalidades
- **Gest√£o de Tickets**: Cria√ß√£o, edi√ß√£o, visualiza√ß√£o e exclus√£o de tickets
- **Kanban Board**: Interface visual para acompanhamento do fluxo de trabalho
- **Sistema de Permiss√µes**: Controle granular baseado em perfis e setores
- **Personaliza√ß√£o**: Customiza√ß√£o de cores, logo e nome do sistema
- **Dashboard Analytics**: Vis√£o geral com m√©tricas e indicadores
- **Modo Escuro**: Interface adapt√°vel para diferentes prefer√™ncias

---

## üé´ Fluxo de Tickets

### Cria√ß√£o de Tickets

#### Processo Unificado
- **Bot√£o √∫nico**: Existe apenas um bot√£o "Criar Ticket" que unifica IA e cria√ß√£o manual
- **Campos obrigat√≥rios**: Exibem aviso visual (vermelho) quando n√£o preenchidos
- **Contador de caracteres**: Dispon√≠vel em campos de texto longos
- **Interface limpa**: Removida duplica√ß√£o de componentes e corrigido modo escuro

#### Campos Obrigat√≥rios
1. **T√≠tulo**: Descri√ß√£o concisa do ticket
2. **Descri√ß√£o**: Detalhamento do problema/solicita√ß√£o
3. **Tipo de Ticket**: 
   - Bug
   - Feature 
   - Suporte
   - Melhoria
   - Solicita√ß√£o
4. **Prioridade**: P0 (Cr√≠tico), P1 (Alto), P2 (M√©dio), P3 (Baixo)
5. **Time Respons√°vel**: Setor que ser√° respons√°vel pelo ticket
6. **Solicitante**: Preenchido automaticamente com o usu√°rio logado

#### Regras de Neg√≥cio
- O **setor selecionado** na cria√ß√£o √© o respons√°vel pelo ticket
- **N√£o existem mais** perguntas condicionais baseadas no setor
- Usu√°rios **devem ter um setor atribu√≠do** para criar tickets
- Sistema de pontua√ß√£o autom√°tica baseada nos crit√©rios selecionados

### Status dos Tickets

#### Fluxo de Status
1. **Aberto**: Status inicial de todos os tickets criados
2. **Em Andamento**: Ticket sendo trabalhado pela equipe respons√°vel
3. **Resolvido**: Ticket conclu√≠do, aguardando confirma√ß√£o
4. **Fechado**: Ticket finalizado e arquivado

#### Status Especiais
- **Atrasado**: Calculado automaticamente baseado no prazo da prioridade:
  - P0: 4 horas
  - P1: 24 horas  
  - P2: 3 dias
  - P3: 7 dias

**Nota**: A op√ß√£o de "pausar" tickets foi removida do sistema.

### Edi√ß√£o de Tickets

#### Permiss√µes de Edi√ß√£o
- **Super Admin**: Pode editar qualquer ticket
- **L√≠der do Setor**: Pode editar tickets do seu setor
- **Operador**: Pode editar apenas tickets que criou

#### Campos Edit√°veis
- T√≠tulo, descri√ß√£o, tipo, prioridade, time respons√°vel, status, observa√ß√µes
- **Campo n√£o edit√°vel**: Solicitante (mant√©m o criador original)
- **Tags removidas**: Simplifica√ß√£o da interface de edi√ß√£o

#### Valida√ß√µes
- Usu√°rios sem setor atribu√≠do n√£o podem editar tickets
- Verifica√ß√£o de permiss√µes em tempo real
- Log autom√°tico de todas as altera√ß√µes

---

## üë• Permiss√µes e Perfis de Usu√°rio

### Tipos de Usu√°rio

#### Super Admin
- **Acesso total** ao sistema
- Pode editar/excluir qualquer ticket
- Gerencia setores, usu√°rios e permiss√µes
- Acesso ao painel de administra√ß√£o
- Personaliza√ß√£o do sistema (cores, logo, nome)

#### Operador
- Pode **criar tickets**
- Pode **editar apenas tickets que criou**
- Visualiza dashboard e relat√≥rios
- **N√£o pode se transformar em Super Admin** (corre√ß√£o de bug)

#### Viewer
- **Apenas visualiza√ß√£o** do dashboard
- N√£o pode criar tickets
- N√£o v√™ hist√≥rico detalhado
- **N√£o tem acesso** ao menu "Admin"

#### L√≠der de Setor
- Al√©m das permiss√µes de Operador
- Pode **editar/excluir tickets do seu setor**
- Gerencia equipe do setor
- **Apenas 1 l√≠der por setor** √© permitido

### Valida√ß√µes de Setor

#### Regra Principal
Usu√°rios **devem estar atribu√≠dos a um setor** antes de:
- Criar tickets
- Editar tickets
- Acessar funcionalidades de gest√£o

Mensagem exibida: *"Voc√™ precisa ser atribu√≠do a um setor/time antes de criar ou editar tickets. Contate um administrador."*

---

## üìä Kanban e Caixa de Entrada

### Kanban Board

#### Design e Interface
- **Layout minimalista**: Seguindo commit "fix dark mode background"
- **Cores suaves**: Removidas cores pesadas acima das colunas
- **Scroll vertical** restaurado para melhor navega√ß√£o
- **Responsivo**: Adapt√°vel a diferentes tamanhos de tela

#### Funcionalidades de Drag & Drop
- **Modernizado**: Tickets n√£o desaparecem ao serem movidos
- **Drop inteligente**: Funciona em qualquer √°rea da coluna
- **Anima√ß√µes suaves**: Cria√ß√£o autom√°tica de espa√ßo para o ticket
- **Feedback visual**: Sistema reativo e responsivo ao movimento

#### Intera√ß√£o com Tickets
- **Clique**: Abre detalhes do ticket imediatamente
- **Edi√ß√£o**: Bot√£o "Editar" aparece no hover do card
- **Arrastar**: Funcionalidade completa de drag & drop para mudan√ßa de status

### Caixa de Entrada

#### Interface Limpa
- **Tags desnecess√°rias removidas**: Layout mais clean e focado
- **Op√ß√µes essenciais**: Apenas Editar e Visualizar dispon√≠veis
- **Filtros otimizados**: Sistema inteligente de filtragem

#### Sistema de Busca Inteligente
- **Autocomplete**: Sugere tickets conforme digita√ß√£o
- **Busca Google-like**: Busca inteligente por palavras-chave
- **Filtros m√∫ltiplos**: Combina√ß√£o de texto, status e setor

#### Corre√ß√µes de Filtros
- **L√≥gica corrigida**: Setor mostra apenas tickets corretos
- **Bug resolvido**: Cards n√£o ficam mais "presos" ao selecionar cr√≠ticos
- **Performance melhorada**: Filtros mais responsivos

---

## üé® Personaliza√ß√£o do Sistema

### Customiza√ß√µes Dispon√≠veis (Super Admin)

#### Identidade Visual
1. **Nome do Sistema**: Alterar "Manhattan" para qualquer nome desejado
2. **Logo do Sistema**: Upload e gerenciamento de logo personalizada
3. **Cores do Sistema**: Personaliza√ß√£o completa da paleta de cores
4. **Tema**: Modo claro/escuro com persist√™ncia de prefer√™ncia

#### Configura√ß√µes T√©cnicas
- **Armazenamento**: Logo e configura√ß√µes salvas no Supabase
- **Carregamento autom√°tico**: Aplica√ß√£o das personaliza√ß√µes na inicializa√ß√£o
- **Cache otimizado**: Performance mantida mesmo com customiza√ß√µes

---

## ‚öôÔ∏è Administra√ß√£o do Sistema

### Gest√£o de Permiss√µes

#### Cargos e Fun√ß√µes
- **Cria√ß√£o de cargos**: Adicionar novos cargos ao sistema
- **Edi√ß√£o**: Modificar permiss√µes existentes
- **Exclus√£o**: Remover cargos desnecess√°rios
- **Interface otimizada**: Bot√µes de a√ß√£o ao lado do t√≠tulo do cargo

#### Permiss√µes Granulares
Cada cargo pode ter permiss√µes espec√≠ficas para:
- Criar tickets
- Editar tickets pr√≥prios
- Editar tickets do setor
- Excluir tickets
- Comentar em tickets
- Resolver tickets

### Gest√£o de Setores

#### Funcionalidades
- **Cria√ß√£o/edi√ß√£o** de setores
- **Atribui√ß√£o de usu√°rios** a setores
- **Defini√ß√£o de l√≠der** (1 por setor)
- **Listagem de membros** da equipe

#### Visualiza√ß√£o
- **Lista completa** de usu√°rios por setor
- **Identifica√ß√£o visual** do l√≠der
- **Gest√£o centralizada** pelo Super Admin

### Limpeza de Interface

#### Elementos Removidos
- Tags irrelevantes como "Admin Master" e "Colaborador"
- Elementos visuais desnecess√°rios
- Duplica√ß√µes de componentes
- √çcones excessivos

---

## üîó Integra√ß√£o com Supabase

### Configura√ß√µes de Seguran√ßa

#### Row Level Security (RLS)
- **Pol√≠ticas otimizadas** para cada tabela
- **Acesso baseado em perfil** de usu√°rio
- **Preven√ß√£o de escala√ß√£o** de privil√©gios

#### Performance
- **Queries otimizadas** para carregamento r√°pido
- **√çndices estrat√©gicos** nas tabelas principais
- **Cache inteligente** para dados frequentes

### Estrutura do Banco

#### Tabelas Principais
- `sla_demandas`: Tickets do sistema
- `profiles`: Perfis de usu√°rio
- `setores`: Departamentos/equipes
- `user_setores`: Relacionamento usu√°rio-setor
- `permissoes_cargo`: Permiss√µes por cargo

#### Logs e Auditoria
- `sla_action_logs`: Log de a√ß√µes nos tickets
- `sla_logs`: Logs gerais do sistema
- `logs_permissoes`: Auditoria de altera√ß√µes de permiss√£o

---

## üé® UI/UX e Design System

### Filosofia de Design

#### Minimalismo Moderno
- **Estilo SaaS**: Interface clean e profissional
- **Elementos essenciais**: Remo√ß√£o de componentes desnecess√°rios
- **Hierarquia visual**: Clara e intuitiva

#### Acessibilidade
- **Contraste otimizado**: Cores adequadas para diferentes contextos
- **Responsividade**: Funciona em tablets, desktops e dispositivos m√≥veis
- **Modo escuro**: Implementa√ß√£o completa com consist√™ncia visual

### Componentes

#### Sistema de Cores
- **Paleta consistente**: Cores harmoniosas e profissionais
- **Estados visuais**: Hover, focus e active bem definidos
- **Corre√ß√µes aplicadas**: Bot√µes verdes sem halo ciano

#### Tipografia
- **Hierarquia clara**: Tamanhos e pesos bem definidos
- **Legibilidade**: Contraste adequado em todos os modos
- **Consist√™ncia**: Uso uniforme em todo o sistema

---

## üöÄ Instala√ß√£o R√°pida

### 1. Clone o Projeto
```bash
git clone <URL_DO_REPOSITORIO>
cd sistema-tickets
```

### 2. Configure o Supabase

#### 2.1. Criar Conta e Projeto
1. Acesse [https://supabase.com](https://supabase.com)
2. Crie uma conta gratuita
3. Clique em "New Project"
4. Escolha sua organiza√ß√£o
5. D√™ um nome para o projeto (ex: "sistema-tickets")
6. Defina uma senha segura para o banco
7. Escolha a regi√£o mais pr√≥xima
8. Clique em "Create new project"

#### 2.2. Obter Credenciais
1. No painel do Supabase, v√° em **Settings** (Configura√ß√µes)
2. V√° em **API**
3. Copie:
   - **URL**: Algo como `https://xxxxxxxxxxxxx.supabase.co`
   - **anon/public key**: Uma string longa come√ßando com `eyJ...`

#### 2.3. Configurar Projeto
1. No projeto Lovable, v√° em **Project Settings** (√≠cone de engrenagem)
2. V√° em **Integrations**
3. Conecte com Supabase usando as credenciais copiadas

### 3. Primeiro Acesso

1. Acesse o projeto no navegador
2. V√° para a p√°gina `/auth`
3. Cadastre o primeiro usu√°rio administrador:
   - **Email**: seu@email.com
   - **Senha**: sua_senha_segura
   - **Nome**: Seu Nome Completo
   - **Tipo**: Super Admin

### 4. Configura√ß√£o Inicial

1. Fa√ßa login com o usu√°rio criado
2. V√° para `/admin` para:
   - Gerenciar usu√°rios e permiss√µes
   - Configurar setores adicionais
   - Atribuir usu√°rios aos setores

---

## üì± Como Usar

### Dashboard Principal (`/`)
- Vis√£o geral dos tickets
- Estat√≠sticas em tempo real
- Acesso r√°pido √†s funcionalidades

### Caixa de Entrada (`/inbox`)
- Lista todos os tickets
- Filtros avan√ßados
- Busca inteligente com autocomplete
- Clique em tickets para ver detalhes

### Kanban Board (`/kanban`)
- Visualiza√ß√£o em colunas por status
- Drag & drop para mudan√ßa de status
- Edi√ß√£o r√°pida de tickets
- Interface responsiva

### √Årea Administrativa (`/admin`)
- Gest√£o de usu√°rios
- Cria√ß√£o e edi√ß√£o de setores
- Configura√ß√£o de permiss√µes
- Personaliza√ß√£o do sistema

---

## üèóÔ∏è Estrutura do Projeto

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ui/                    # Componentes base (shadcn/ui)
‚îÇ   ‚îú‚îÄ‚îÄ Navigation.tsx         # Navega√ß√£o principal
‚îÇ   ‚îú‚îÄ‚îÄ TicketKanban.tsx      # Kanban board
‚îÇ   ‚îú‚îÄ‚îÄ TicketDetailModal.tsx  # Modal detalhado do ticket
‚îÇ   ‚îú‚îÄ‚îÄ TicketEditModal.tsx    # Modal de edi√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ ManualTicketCreator.tsx # Cria√ß√£o de tickets
‚îÇ   ‚îî‚îÄ‚îÄ ThemeToggle.tsx        # Alternador de tema
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ Index.tsx             # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ Inbox.tsx             # Caixa de entrada
‚îÇ   ‚îú‚îÄ‚îÄ Kanban.tsx            # P√°gina do Kanban
‚îÇ   ‚îú‚îÄ‚îÄ Admin.tsx             # √Årea administrativa
‚îÇ   ‚îú‚îÄ‚îÄ Customization.tsx     # Personaliza√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ Auth.tsx              # Autentica√ß√£o
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.tsx           # Hook de autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ usePermissions.tsx    # Hook de permiss√µes
‚îÇ   ‚îú‚îÄ‚îÄ useTheme.tsx          # Hook de tema
‚îÇ   ‚îî‚îÄ‚îÄ useTicketStatus.tsx   # Hook de status
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ supabase-config.ts    # Configura√ß√£o do Supabase
‚îî‚îÄ‚îÄ integrations/
    ‚îî‚îÄ‚îÄ supabase/             # Cliente e tipos do Supabase
```

---

## üìö Changelog

### Vers√£o Atual - 2.0.0

#### ‚úÖ Funcionalidades Implementadas
- [x] Sistema unificado de cria√ß√£o de tickets
- [x] Kanban com drag & drop modernizado
- [x] Permiss√µes granulares por setor
- [x] Personaliza√ß√£o completa do sistema
- [x] Interface otimizada para modo escuro
- [x] Sistema de busca inteligente
- [x] Gest√£o de setores e l√≠deres
- [x] Logs de auditoria completos

#### üîß Corre√ß√µes Aplicadas
- [x] Bug de escala√ß√£o de privil√©gios
- [x] Filtros de setor corrigidos
- [x] Drag & drop do Kanban restaurado
- [x] Interface de cria√ß√£o duplicada removida
- [x] Cores e contrastes melhorados
- [x] Responsividade em todas as telas

#### üóëÔ∏è Elementos Removidos
- [x] Perguntas condicionais por setor
- [x] Op√ß√£o de pausar tickets
- [x] Tags desnecess√°rias da interface
- [x] Elementos visuais excessivos
- [x] Duplica√ß√µes de componentes

#### üé® Melhorias de UI/UX
- [x] Design minimalista estilo SaaS
- [x] Intera√ß√µes mais fluidas
- [x] Anima√ß√µes suaves
- [x] Contraste otimizado
- [x] Modo escuro completo

---

## üõ†Ô∏è Guia de Desenvolvimento

### Tecnologias Utilizadas
- **Frontend**: React 18, TypeScript, Tailwind CSS
- **Backend**: Supabase (PostgreSQL, Auth, Storage)
- **Build**: Vite
- **UI Components**: Radix UI, Lucide Icons
- **Drag & Drop**: @dnd-kit

### Comandos Principais
```bash
# Instala√ß√£o
npm install

# Desenvolvimento
npm run dev

# Build
npm run build

# Typecheck
npm run typecheck
```

### Estrutura de Dados

#### Principais Entidades
- **Tickets**: Demandas principais do sistema
- **Usu√°rios**: Perfis e autentica√ß√£o
- **Setores**: Organiza√ß√£o departamental
- **Permiss√µes**: Controle de acesso granular

#### Relacionamentos
- Usu√°rio ‚Üî Setor (muitos para muitos)
- Ticket ‚Üí Setor (muitos para um)
- Ticket ‚Üí Usu√°rio (muitos para um - criador)

---

## üìû Suporte

Para d√∫vidas t√©cnicas ou sugest√µes de melhorias, entre em contato com a equipe de desenvolvimento.

### Recursos √öteis
- **Documenta√ß√£o do Supabase**: [supabase.com/docs](https://supabase.com/docs)
- **Guia do Tailwind CSS**: [tailwindcss.com/docs](https://tailwindcss.com/docs)
- **React Documentation**: [react.dev](https://react.dev)
- **Lovable Documentation**: [docs.lovable.dev](https://docs.lovable.dev)

---

*Documenta√ß√£o atualizada em: Janeiro 2025*  
*Vers√£o do Sistema: 2.0.0*  
*√öltima revis√£o: Sistema de Gest√£o de Tickets Manhattan*